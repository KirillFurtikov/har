require.def("preview/harModel",["core/lib","preview/jsonSchema","preview/ref","preview/harSchema","core/cookies","core/trace","jquery-plugins/jquery.json"],function(i,m,n,o,j,k){function f(){this.input=null}function p(){var a={};for(var c in this)if(c!="toJSON")a[c]=this[c];if(!this.text)return a;a.text=Array.map(this.text,function(b){var d=b.charCodeAt(0);if(d>=32&&d<127||d==10||d==13)return b.charAt(0);for(b=d.toString(16).toUpperCase();b.length<4;)b="0"+b;return"\\u"+b}).join("");return a}f.prototype=
{append:function(a){if(a){if(this.input)if(a.log.pages)for(var c=0;c<a.log.pages.length;c++)this.importPage(a.log.pages[c],a.log.entries);else{k.error("Import of additional data without a page is not yet supported.");return null}else this.input=a;return this.input}else k.error("HarModel.append; Trying to append null input!")},getPages:function(){if(!this.input)return[];return this.input.log.pages?this.input.log.pages:[]},getFirstPage:function(){var a=this.getPages();return a.length>0?a[0]:null},getPageEntries:function(a){return f.getPageEntries(this.input,
a)},getAllEntries:function(){return this.input?this.input.log.entries:[]},getParentPage:function(a){return f.getParentPage(this.input,a)},importPage:function(a,c){var b=this.getUniquePageID(a.id),d=a.id;a.id=b;this.input.log.pages.push(a);for(a=0;a<c.length;a++){var e=c[a];if(e.pageref==d){e.pageref=b;this.input.log.entries.push(e)}}},getUniquePageID:function(a){for(var c=this.input.log.pages,b={},d=0;d<c.length;d++)b[c[d].id]=true;if(!b[a])return a;for(c=1;;){d=a+c;if(!b[d])return d;c++}},toJSON:function(a){if(!a)a=
this.input;if(!a)return"";a=this.input.log.entries;for(var c=0;c<a.length;c++){var b=a[c];if(b.response.content.text)b.response.content.toJSON=p}return $.jSONToString(this.input,null,"\t").replace(/\\\\u/g,"\\u")},getSize:function(a){if(!a)a=this.input;if(!a)return 0;return dojo.toJson(a,true).length}};f.parse=function(a,c){var b=a;try{if(typeof a==="string")b=jQuery.toJSON(a)}catch(d){console.exception("HarModel.parse; EXCEPTION",d);throw{errors:[{message:"Failed to parse JSON",property:"JSON evaluation"}]};
}if(!c)return b;a=n.resolveJson(o);a=m.validate(b,a.logType);if(a.valid)return b;throw a;};f.getPageEntries=function(a,c){var b=[];a=a.log.entries;if(!a)return b;for(var d=0;d<a.length;d++){var e=a[d];!e.pageref&&!c&&b.push(e);c&&e.pageref==c.id&&b.push(e)}return b};f.getParentPage=function(a,c){a=a.log.pages;if(!a)return null;for(var b=0;b<a.length;b++)if(a[b].id==c.pageref)return a[b];return null};f.Loader={run:function(a,c){var b=i.getURLParameter("baseUrl");if(b&&b[b.length-1]!="/")b+="/";var d=
i.getURLParameters("path"),e=i.getURLParameter("callback"),h=i.getURLParameter("inputUrl"),g=[];for(var l in d)g.push(b?b+d[l]:d[l]);h&&g.push(h);if((b||h)&&g.length>0)return this.loadRemoteArchive(g,e,a,c);if(b=i.getURLParameter("path"))return this.loadLocalArchive(b,a,c)},loadExample:function(a){var c=document.location.href,b=c.indexOf("?");document.location=c.substr(0,b)+"?path="+a;j.setCookie("timeline",true);j.setCookie("stats",true)},loadLocalArchive:function(a,c,b){$.ajax({url:a,context:this,
success:function(d){c(d)},error:function(d,e){b(d,e)}});return true},loadRemoteArchive:function(a,c,b,d){if(!a.length)return false;var e=a.shift();c||(c="onInputData");$.ajax({url:e,context:this,dataType:"jsonp",jsonp:"callback",jsonpCallback:c,success:function(h){b(h);if(a.length){var g=this;setTimeout(function(){g.loadRemoteArchive(a,c,b,d)},300)}},error:function(h,g){d(h,g)}});return true}};return f});