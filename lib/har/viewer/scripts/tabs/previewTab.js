require.def("tabs/previewTab",["domplate/domplate","domplate/tabView","core/lib","i18n!nls/previewTab","domplate/toolbar","tabs/pageTimeline","tabs/pageStats","preview/pageList","core/cookies","downloadify/js/swfobject","downloadify/src/downloadify"],function(e,h,d,c,i,j,k,l,f){with(e){e=function(a){this.model=a;this.toolbar=new i;this.timeline=new j;this.stats=new k(a,this.timeline);a=this.getToolbarButtons();for(var b=0;b<a.length;b++)this.toolbar.addButton(a[b])};e.prototype=d.extend(h.Tab.prototype,
{id:"Preview",label:c.previewTabLabel,tabBodyTag:DIV({"class":"tab$tab.id\\Body tabBody",_repObject:"$tab"},DIV({"class":"previewToolbar"}),DIV({"class":"previewTimeline"}),DIV({"class":"previewStats"}),DIV({"class":"previewList"})),errorTable:TABLE({"class":"errorTable",cellpadding:0,cellspacing:5},TBODY(FOR("error","$errors",TR({"class":"errorRow",_repObject:"$error"},TD({"class":"errorProperty"},SPAN("$error.property")),TD("&nbsp;"),TD({"class":"errorMessage"},SPAN("$error.message")))))),onUpdateBody:function(a,
b){this.toolbar.render(d.$(b,"previewToolbar"));this.stats.render(d.$(b,"previewStats"));this.timeline.render(d.$(b,"previewTimeline"));(a=this.model.input)&&f.getCookie("timeline")=="true"&&this.onTimeline(false);a&&f.getCookie("stats")=="true"&&this.onStats(false);var g=this.model;$(".harDownloadButton").downloadify({filename:function(){return"netData.har"},data:function(){return g?g.toJSON():""},onComplete:function(){},onCancel:function(){},onError:function(){alert(c.downloadError)},swf:"scripts/downloadify/media/downloadify.swf",
downloadImage:"css/images/download-sprites.png",width:16,height:16,transparent:true,append:false})},getToolbarButtons:function(){var a=[{id:"showTimeline",label:c.showTimelineButton,tooltiptext:c.showTimelineTooltip,command:d.bindFixed(this.onTimeline,this,true)},{id:"showStats",label:c.showStatsButton,tooltiptext:c.showStatsTooltip,command:d.bindFixed(this.onStats,this,true)},{label:c.clearButton,tooltiptext:c.clearTooltip,command:d.bindFixed(this.onClear,this)}];$.browser.mozilla&&a.push({tooltiptext:c.downloadTooltip,
className:"harDownloadButton"});return a},onTimeline:function(a){this.timeline.toggle(a);a=this.toolbar.getButton("showTimeline");var b=this.timeline.isVisible();a.label=c[b?"hideTimelineButton":"showTimelineButton"];this.toolbar.render();f.setCookie("timeline",b)},onStats:function(a){this.stats.toggle(a);a=this.toolbar.getButton("showStats");var b=this.stats.isVisible();a.label=c[b?"hideStatsButton":"showStatsButton"];this.toolbar.render();f.setCookie("stats",b)},onClear:function(){var a=document.location.href,
b=a.indexOf("?");document.location=a.substr(0,b)},append:function(a){(new l(a)).append(d.$(this._body,"previewList"));this.timeline.append(a)},appendError:function(a){a.errors&&this.errorTable.append(a,d.$(this._body,"previewList"))}});return e}});